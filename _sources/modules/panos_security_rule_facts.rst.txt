.. _panos_security_rule_facts_module:


panos_security_rule_facts -- Retrieve information about security rules.
=======================================================================

.. contents::
   :local:
   :depth: 1


Synopsis
--------

Retrieve information about security rules.




Requirements
------------
The below requirements are needed on the host that executes this module.

- pan-python
- pandevice



Parameters
----------

  rule_name (type: str)
    Name of the security rule.


  names (type: list)
    List of security rule names to return data for.


  details (type: bool)
    Retrieve full details instead of just rule names.

    Implied when *names* is set and not using *match_rules*.


  match_rules (type: dict)
    Returns security rule(s) in the policy that will match the specified traffic using the 'test security-policy-match' API command.


    source_zone (required, type: str)
      Source zone


    source_ip (required, type: str)
      Source IP address


    source_user (type: str)
      Source user


    destination_zone (required, type: str)
      Destination zone


    destination_ip (required, type: str)
      Destination IP address


    destination_port (required, type: str)
      Destination port


    protocol (required, type: str)
      IP protocol type


    application (type: str)
      Application name


    category (type: str)
      URL filtering category


    show_all (type: bool)
      Show all potential matches until first allow rule



  provider (type: dict)
    A dict object containing connection details.


    ip_address (type: str)
      The IP address or hostname of the PAN-OS device being configured.


    username (type: str, default: admin)
      The username to use for authentication.  This is ignored if *api_key* is specified.


    password (type: str)
      The password to use for authentication.  This is ignored if *api_key* is specified.


    api_key (type: str)
      The API key to use instead of generating it using *username* / *password*.


    port (type: int, default: 443)
      The port number to connect to the PAN-OS device on.


    serial_number (type: str)
      The serial number of a firewall to use for targeted commands. If *ip_address* is not a Panorama PAN-OS device, then this param is ignored.



  ip_address (type: str)
    **Deprecated**

    Use *provider* to specify PAN-OS connectivity instead.

    ------------

    The IP address or hostname of the PAN-OS device being configured.


  username (type: str, default: admin)
    **Deprecated**

    Use *provider* to specify PAN-OS connectivity instead.

    ------------

    The username to use for authentication.  This is ignored if *api_key* is specified.


  password (type: str)
    **Deprecated**

    Use *provider* to specify PAN-OS connectivity instead.

    ------------

    The password to use for authentication.  This is ignored if *api_key* is specified.


  api_key (type: str)
    **Deprecated**

    Use *provider* to specify PAN-OS connectivity instead.

    ------------

    The API key to use instead of generating it using *username* / *password*.


  port (type: int, default: 443)
    **Deprecated**

    Use *provider* to specify PAN-OS connectivity instead.

    ------------

    The port number to connect to the PAN-OS device on.


  device_group (type: str, default: shared)
    (Panorama only) The device group the operation should target.


  vsys (type: str, default: vsys1)
    The vsys this object belongs to.


  rulebase (type: str)
    The rulebase in which the rule is to exist.  If left unspecified, this defaults to *rulebase=pre-rulebase* for Panorama.  For NGFW, this is always set to be *rulebase=rulebase*.





Notes
-----

.. note::
   - Checkmode is not supported.
   - Panorama is supported.
   - PAN-OS connectivity should be specified using *provider* or the classic PAN-OS connectivity params (*ip_address*, *username*, *password*, *api_key*, and *port*).  If both are present, then the classic params are ignored.




Examples
--------

.. code-block:: yaml+jinja

    
    - name: Get a list of all security rules
      panos_security_rule_facts:
        provider: '{{ provider }}'
      register: sec_rules

    - debug:
        msg: '{{ sec_rules.rule_names }}'

    - name: Get the definition for rule 'HTTP Multimedia'
      panos_security_rule_facts:
        provider: '{{ provider }}'
        names:
            - 'HTTP Multimedia'
      register: rule1

    - debug:
        msg: '{{ rule1.spec }}'

    - name: Get rule names matching DNS traffic
      panos_security_rule_facts:
        provider: '{{ provider }}'
        match_rules:
          source_zone: 'trust'
          source_ip: '192.168.1.10'
          destination_zone: 'untrust'
          destination_ip: '8.8.8.8'
          destination_port: '53'
          protocol: 'udp'
      register: dns_rule

    - debug:
        msg: '{{ dns_rule.spec }}'



Return Values
-------------

rule_names (When I(details=False), list, ['rule1', 'rule2', 'rule3'])
  List of security rules present, or matching traffic as specified in *match_rules*.


rule_details (When I(details=True), list, )
  Full details of requested security rules, or matching traffic as specified in *match_rules*.


  rule_name (, str, )
    Name of the security rule.


  source_zone (, list, )
    List of source zones.


  source_ip (, list, )
    List of source addresses.


  source_user (, list, )
    List of source users.


  hip_profiles (, list, )
    GlobalProtect host information profile list.


  destination_zone (, list, )
    List of destination zones.


  destination_ip (, list, )
    List of destination addresses.


  application (, list, )
    List of applications, application groups, and/or application filters.


  service (, list, )
    List of services and/or service groups.


  category (, list, )
    List of destination URL categories.


  action (, str, )
    The rule action.


  log_setting (, str, )
    Log forwarding profile.


  log_start (, bool, )
    Whether to log at session start.


  log_end (, bool, )
    Whether to log at session end.


  description (, str, )
    Description of the security rule.


  rule_type (, str, )
    Type of security rule (version 6.1 of PanOS and above).


  tag_name (, list, )
    List of tags associated with the rule.


  negate_source (, bool, )
    Match on the reverse of the 'source_ip' attribute


  negate_destination (, bool, )
    Match on the reverse of the 'destination_ip' attribute


  disabled (, bool, )
    Disable this rule.


  schedule (, str, )
    Schedule in which this rule is active.


  icmp_unreachable (, bool, )
    Send 'ICMP Unreachable'.


  disable_server_response_inspection (, bool, )
    Disables packet inspection from the server to the client.


  group_profile (, str, )
    Security profile group setting.


  antivirus (, str, )
    Name of the already defined antivirus profile.


  vulnerability (, str, )
    Name of the already defined vulnerability profile.


  spyware (, str, )
    Name of the already defined spyware profile.


  url_filtering (, str, )
    Name of the already defined url_filtering profile.


  file_blocking (, str, )
    Name of the already defined file_blocking profile.


  data_filtering (, str, )
    Name of the already defined data_filtering profile.


  wildfire_analysis (, str, )
    Name of the already defined wildfire_analysis profile.






Status
------





Authors
~~~~~~~

- Garfield Lee Freeman (@shinmog)
- Michael Richardson (@mrichardson03)

