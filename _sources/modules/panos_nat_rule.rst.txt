.. _panos_nat_rule_module:


panos_nat_rule -- create a policy NAT rule
==========================================

.. contents::
   :local:
   :depth: 1


Synopsis
--------

Create a policy nat rule. Keep in mind that we can either end up configuring source NAT, destination NAT, or both.

Instead of splitting it into two we will make a fair attempt to determine which one the user wants.


.. WARNING::
   This module is **deprecated**, and will be removed in version 3.0.0
   of the collection.

   The design of this module is not consistent with current design.

   Use M(panos_nat_rule2) instead.



Requirements
------------
The below requirements are needed on the host that executes this module.

- pan-python >= 0.16
- pan-os-python >= 1.7.3



Parameters
----------

  state (type: str, default: present)
    The state of this object.


  operation (type: str)
    **Removed**

    Use *state* instead.


  devicegroup (type: str)
    **Deprecated**

    Use *device_group* instead.

    ------------

    The device group to place the NAT rule into.

    Panorama only; ignored for firewalls.


  tag (type: list)
    Administrative tags.


  tag_name (type: str)
    **Deprecated**

    Use *tag* instead.

    ------------

    Administrative tag.


  rule_name (required, type: str)
    name of the SNAT rule


  description (type: str)
    NAT rule description.


  nat_type (type: str, default: ipv4)
    Type of NAT.


  source_zone (type: list)
    list of source zones


  source_ip (type: list, default: ['any'])
    list of source addresses


  destination_zone (type: str)
    destination zone


  destination_ip (type: list, default: ['any'])
    list of destination addresses


  to_interface (type: str, default: any)
    Original packet's destination interface.


  service (type: str, default: any)
    service


  snat_type (type: str)
    type of source translation


  snat_address_type (type: str, default: interface-address)
    type of source translation.


  snat_static_address (type: str)
    Source NAT translated address. Used with Static-IP translation.


  snat_dynamic_address (type: list)
    Source NAT translated address.

    Used when *snat_type=dynamic-ip* or *snat_type=dynamic-ip-and-port*.


  snat_interface (type: str)
    snat interface


  snat_interface_address (type: str)
    snat interface address


  snat_bidirectional (type: bool)
    bidirectional flag


  dnat_address (type: str)
    Static dnat translated address

    Mutually exclusive with *dnat_dynamic_address*, *dnat_dynamic_port*, and *dnat_dynamic_distribution*.


  dnat_port (type: str)
    Static dnat translated port

    Mutually exclusive with *dnat_dynamic_address*, *dnat_dynamic_port*, and *dnat_dynamic_distribution*.


  group_tag (type: str)
    The group tag.


  dnat_dynamic_address (type: str)
    Dynamic destination translated address.

    Mutually exclusive with *dnat_address* and *dnat_port*.


  dnat_dynamic_port (type: int)
    Dynamic destination translated port.

    Mutually exclusive with *dnat_address* and *dnat_port*.


  dnat_dynamic_distribution (type: str)
    Dynamic destination translated distribution.

    Mutually exclusive with *dnat_address* and *dnat_port*.


  provider (type: dict)
    A dict object containing connection details.


    ip_address (type: str)
      The IP address or hostname of the PAN-OS device being configured.


    username (type: str, default: admin)
      The username to use for authentication.  This is ignored if *api_key* is specified.


    password (type: str)
      The password to use for authentication.  This is ignored if *api_key* is specified.


    api_key (type: str)
      The API key to use instead of generating it using *username* / *password*.


    port (type: int, default: 443)
      The port number to connect to the PAN-OS device on.


    serial_number (type: str)
      The serial number of a firewall to use for targeted commands. If *ip_address* is not a Panorama PAN-OS device, then this param is ignored.



  ip_address (type: str)
    **Deprecated**

    Use *provider* to specify PAN-OS connectivity instead.

    ------------

    The IP address or hostname of the PAN-OS device being configured.


  username (type: str, default: admin)
    **Deprecated**

    Use *provider* to specify PAN-OS connectivity instead.

    ------------

    The username to use for authentication.  This is ignored if *api_key* is specified.


  password (type: str)
    **Deprecated**

    Use *provider* to specify PAN-OS connectivity instead.

    ------------

    The password to use for authentication.  This is ignored if *api_key* is specified.


  api_key (type: str)
    **Deprecated**

    Use *provider* to specify PAN-OS connectivity instead.

    ------------

    The API key to use instead of generating it using *username* / *password*.


  port (type: int, default: 443)
    **Deprecated**

    Use *provider* to specify PAN-OS connectivity instead.

    ------------

    The port number to connect to the PAN-OS device on.


  device_group (type: str, default: shared)
    (Panorama only) The device group the operation should target.


  vsys (type: str, default: vsys1)
    The vsys this object belongs to.


  rulebase (type: str)
    The rulebase in which the rule is to exist.  If left unspecified, this defaults to *rulebase=pre-rulebase* for Panorama.  For NGFW, this is always set to be *rulebase=rulebase*.


  commit (type: bool)
    **Deprecated**

    Please use :ref:`panos_commit_firewall <panos_commit_firewall_module>`, :ref:`panos_commit_panorama <panos_commit_panorama_module>`, :ref:`panos_commit_push <panos_commit_push_module>` instead.

    ------------

    Commit changes after creating object.  If *ip_address* is a Panorama device, and *device_group* or *template* are also set, perform a commit to Panorama and a commit-all to the device group/template.


  uuid (type: str)
    The rule UUID.

    Note that this is currently more of a read-only field.

    Usage of the UUID cannot currently take the place of using the rule name as the primary identifier.


  target (type: list)
    Applicable for Panorama only.

    Apply this rule exclusively to the listed firewall serial numbers.


  negate_target (type: bool)
    Applicable for Panorama only.

    Negate the value for *target*.


  location (type: str)
    Position to place the rule in.


  existing_rule (type: str)
    - If *location=before* or *location=after*, this option specifies
  an existing rule name.  The rule being managed by this module will
  be positioned relative to the value of this parameter.
- Required if *location=before* or *location=after*.



  audit_comment (type: str)
    Add an audit comment to the rule being defined.

    This is only applied if there was a change to the rule.





Notes
-----

.. note::
   - Checkmode is supported.
   - Panorama is supported.
   - PAN-OS connectivity should be specified using *provider* or the classic PAN-OS connectivity params (*ip_address*, *username*, *password*, *api_key*, and *port*).  If both are present, then the classic params are ignored.




Examples
--------

.. code-block:: yaml+jinja

    
    # Create a source and destination nat rule
    - name: Create NAT SSH rule for 10.0.1.101
      panos_nat_rule:
        provider: '{{ provider }}'
        rule_name: "Web SSH"
        source_zone: ["external"]
        destination_zone: "external"
        source_ip: ["any"]
        destination_ip: ["10.0.0.100"]
        service: "service-tcp-221"
        snat_type: "dynamic-ip-and-port"
        snat_interface: "ethernet1/2"
        dnat_address: "10.0.1.101"
        dnat_port: "22"

    - name: disable a specific security rule
      panos_nat_rule:
        provider: '{{ provider }}'
        rule_name: 'Prod-Legacy 1'
        state: 'disable'





Status
------


- This module will be removed in version
  3.0.0.
  *[deprecated]*


Authors
~~~~~~~

- Luigi Mori (@jtschichold)
- Ivan Bojer (@ivanbojer)
- Robert Hagen (@stealthllama)
- Michael Richardson (@mrichardson03)
- Garfield Lee Freeman (@shinmog)
- Ken Celenza (@itdependsnetworks)

