.. _panos_nat_rule_module:


panos_nat_rule -- create a policy NAT rule
==========================================

.. contents::
   :local:
   :depth: 1


Synopsis
--------

Create a policy nat rule. Keep in mind that we can either end up configuring source NAT, destination NAT, or both.

Instead of splitting it into two we will make a fair attempt to determine which one the user wants.




Requirements
------------
The below requirements are needed on the host that executes this module.

- pan-python can be obtained from PyPI https://pypi.python.org/pypi/pan-python
- pandevice can be obtained from PyPI https://pypi.python.org/pypi/pandevice



Parameters
----------

  state (type: str, default: present)
    The state of the NAT rule.


  operation (type: str)
    **Removed**

    Use *state* instead.


  devicegroup (type: str)
    **Deprecated**

    Use *device_group* instead.

    ------------

    The device group to place the NAT rule into.

    Panorama only; ignored for firewalls.


  tag (type: list)
    Administrative tags.


  tag_name (type: str)
    **Deprecated**

    Use *tag* instead.

    ------------

    Administrative tag.


  rule_name (required, type: str)
    name of the SNAT rule


  description (type: str)
    NAT rule description.


  nat_type (type: str, default: ipv4)
    Type of NAT.


  source_zone (type: list)
    list of source zones


  source_ip (type: list, default: ['any'])
    list of source addresses


  destination_zone (type: str)
    destination zone


  destination_ip (type: list, default: ['any'])
    list of destination addresses


  to_interface (type: str, default: any)
    Original packet's destination interface.


  service (type: str, default: any)
    service


  snat_type (type: str)
    type of source translation


  snat_address_type (type: str, default: interface-address)
    type of source translation.


  snat_static_address (type: str)
    Source NAT translated address. Used with Static-IP translation.


  snat_dynamic_address (type: list)
    Source NAT translated address.

    Used when *snat_type=dynamic-ip* or *snat_type=dynamic-ip-and-port*.


  snat_interface (type: str)
    snat interface


  snat_interface_address (type: str)
    snat interface address


  snat_bidirectional (type: bool)
    bidirectional flag


  dnat_address (type: str)
    dnat translated address


  dnat_port (type: str)
    dnat translated port


  location (type: str)
    Position to place the created rule in the rule base.


  existing_rule (type: str)
    If *location=before* or *location=after*, this option specifies an existing rule name.  The new rule will be created in the specified position relative to this rule.

    If *location=before* or *location=after*, *existing_rule* is required.


  commit (type: bool)
    Commit configuration if changed.


  provider (type: )
    A dict object containing connection details.


    ip_address (type: str)
      The IP address or hostname of the PAN-OS device being configured.


    username (type: str, default: admin)
      The username to use for authentication.  This is ignored if *api_key* is specified.


    password (type: str)
      The password to use for authentication.  This is ignored if *api_key* is specified.


    api_key (type: str)
      The API key to use instead of generating it using *username* / *password*.


    port (type: int, default: 443)
      The port number to connect to the PAN-OS device on.


    serial_number (type: str)
      The serial number of a firewall to use for targeted commands. If *ip_address* is not a Panorama PAN-OS device, then this param is ignored.



  ip_address (type: str)
    **Deprecated**

    Use *provider* to specify PAN-OS connectivity instead.

    ------------

    The IP address or hostname of the PAN-OS device being configured.


  username (type: str, default: admin)
    **Deprecated**

    Use *provider* to specify PAN-OS connectivity instead.

    ------------

    The username to use for authentication.  This is ignored if *api_key* is specified.


  password (type: str)
    **Deprecated**

    Use *provider* to specify PAN-OS connectivity instead.

    ------------

    The password to use for authentication.  This is ignored if *api_key* is specified.


  api_key (type: str)
    **Deprecated**

    Use *provider* to specify PAN-OS connectivity instead.

    ------------

    The API key to use instead of generating it using *username* / *password*.


  port (type: int, default: 443)
    **Deprecated**

    Use *provider* to specify PAN-OS connectivity instead.

    ------------

    The port number to connect to the PAN-OS device on.


  device_group (type: str, default: shared)
    (Panorama only) The device group the operation should target.


  vsys (type: str, default: vsys1)
    The vsys this object belongs to.


  rulebase (type: str)
    The rulebase in which the rule is to exist.  If left unspecified, this defaults to *rulebase=pre-rulebase* for Panorama.  For NGFW, this is always set to be *rulebase=rulebase*.





Notes
-----

.. note::
   - Checkmode is supported.
   - Panorama is supported.
   - PAN-OS connectivity should be specified using *provider* or the classic PAN-OS connectivity params (*ip_address*, *username*, *password*, *api_key*, and *port*).  If both are present, then the classic params are ignored.




Examples
--------

.. code-block:: yaml+jinja

    
    # Create a source and destination nat rule
    - name: Create NAT SSH rule for 10.0.1.101
      panos_nat_rule:
        provider: '{{ provider }}'
        rule_name: "Web SSH"
        source_zone: ["external"]
        destination_zone: "external"
        source_ip: ["any"]
        destination_ip: ["10.0.0.100"]
        service: "service-tcp-221"
        snat_type: "dynamic-ip-and-port"
        snat_interface: "ethernet1/2"
        dnat_address: "10.0.1.101"
        dnat_port: "22"

    - name: disable a specific security rule
      panos_nat_rule:
        provider: '{{ provider }}'
        rule_name: 'Prod-Legacy 1'
        state: 'disable'





Status
------




- This module is not guaranteed to have a backwards compatible interface. *[preview]*


- This module is maintained by community.



Authors
~~~~~~~

- Luigi Mori (@jtschichold)
- Ivan Bojer (@ivanbojer)
- Robert Hagen (@stealthllama)
- Michael Richardson (@mrichardson03)
- Garfield Lee Freeman (@shinmog)
- Ken Celenza (@itdependsnetworks)

