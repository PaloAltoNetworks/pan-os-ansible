.. _panos_security_rule_facts_module:


panos_security_rule_facts -- Get information about a security rule.
===================================================================

.. contents::
   :local:
   :depth: 1


Synopsis
--------

Get information about a single security rule or the names of all security rules.




Requirements
------------
The below requirements are needed on the host that executes this module.

- pan-python
- pandevice



Parameters
----------

  rule_name (type: str)
    Name of the security rule.


  all_details (type: bool)
    Get full-policy details when name is not set.


  provider (type: )
    A dict object containing connection details.


    ip_address (type: str)
      The IP address or hostname of the PAN-OS device being configured.


    username (type: str, default: admin)
      The username to use for authentication.  This is ignored if *api_key* is specified.


    password (type: str)
      The password to use for authentication.  This is ignored if *api_key* is specified.


    api_key (type: str)
      The API key to use instead of generating it using *username* / *password*.


    port (type: int, default: 443)
      The port number to connect to the PAN-OS device on.


    serial_number (type: str)
      The serial number of a firewall to use for targeted commands. If *ip_address* is not a Panorama PAN-OS device, then this param is ignored.



  ip_address (type: str)
    **Deprecated**

    Use *provider* to specify PAN-OS connectivity instead.

    ------------

    The IP address or hostname of the PAN-OS device being configured.


  username (type: str, default: admin)
    **Deprecated**

    Use *provider* to specify PAN-OS connectivity instead.

    ------------

    The username to use for authentication.  This is ignored if *api_key* is specified.


  password (type: str)
    **Deprecated**

    Use *provider* to specify PAN-OS connectivity instead.

    ------------

    The password to use for authentication.  This is ignored if *api_key* is specified.


  api_key (type: str)
    **Deprecated**

    Use *provider* to specify PAN-OS connectivity instead.

    ------------

    The API key to use instead of generating it using *username* / *password*.


  port (type: int, default: 443)
    **Deprecated**

    Use *provider* to specify PAN-OS connectivity instead.

    ------------

    The port number to connect to the PAN-OS device on.


  device_group (type: str, default: shared)
    (Panorama only) The device group the operation should target.


  vsys (type: str, default: vsys1)
    The vsys this object belongs to.


  rulebase (type: str)
    The rulebase in which the rule is to exist.  If left unspecified, this defaults to *rulebase=pre-rulebase* for Panorama.  For NGFW, this is always set to be *rulebase=rulebase*.





Notes
-----

.. note::
   - Checkmode is not supported.
   - Panorama is supported.
   - PAN-OS connectivity should be specified using *provider* or the classic PAN-OS connectivity params (*ip_address*, *username*, *password*, *api_key*, and *port*).  If both are present, then the classic params are ignored.




Examples
--------

.. code-block:: yaml+jinja

    
    - name: Get a list of all security rules
      panos_security_rule_facts:
        provider: '{{ provider }}'
      register: sec_rules

    - debug:
        msg: '{{ sec_rules.rules }}'

    - name: Get the definition for rule 'HTTP Multimedia'
      panos_security_rule_facts:
        provider: '{{ provider }}'
        rule_name: 'HTTP Multimedia'
      register: rule1

    - debug:
        msg: '{{ rule1.spec }}'



Return Values
-------------

rules (When I(rule_name) is not specified and I(all_details) is False, list, ['rule1', 'rule2', 'rule3'])
  List of security rules present


policy (When I(rule_name) is not specified and I(all_details) is True, complex, )
  List of security rules present with details


  rule_name (, str, )
    Name of the security rule.


  source_zone (, list, )
    List of source zones.


  source_ip (, list, )
    List of source addresses.


  source_user (, list, )
    List of source users.


  hip_profiles (, list, )
    GlobalProtect host information profile list.


  destination_zone (, list, )
    List of destination zones.


  destination_ip (, list, )
    List of destination addresses.


  application (, list, )
    List of applications, application groups, and/or application filters.


  service (, list, )
    List of services and/or service groups.


  category (, list, )
    List of destination URL categories.


  action (, str, )
    The rule action.


  log_setting (, str, )
    Log forwarding profile.


  log_start (, bool, )
    Whether to log at session start.


  log_end (, bool, )
    Whether to log at session end.


  description (, str, )
    Description of the security rule.


  rule_type (, str, )
    Type of security rule (version 6.1 of PanOS and above).


  tag_name (, list, )
    List of tags associated with the rule.


  negate_source (, bool, )
    Match on the reverse of the 'source_ip' attribute


  negate_destination (, bool, )
    Match on the reverse of the 'destination_ip' attribute


  disabled (, bool, )
    Disable this rule.


  schedule (, str, )
    Schedule in which this rule is active.


  icmp_unreachable (, bool, )
    Send 'ICMP Unreachable'.


  disable_server_response_inspection (, bool, )
    Disables packet inspection from the server to the client.


  group_profile (, str, )
    Security profile group setting.


  antivirus (, str, )
    Name of the already defined antivirus profile.


  vulnerability (, str, )
    Name of the already defined vulnerability profile.


  spyware (, str, )
    Name of the already defined spyware profile.


  url_filtering (, str, )
    Name of the already defined url_filtering profile.


  file_blocking (, str, )
    Name of the already defined file_blocking profile.


  data_filtering (, str, )
    Name of the already defined data_filtering profile.


  wildfire_analysis (, str, )
    Name of the already defined wildfire_analysis profile.



spec (When I(rule_name) is specified, complex, )
  The security rule definition


  rule_name (, str, )
    Name of the security rule.


  source_zone (, list, )
    List of source zones.


  source_ip (, list, )
    List of source addresses.


  source_user (, list, )
    List of source users.


  hip_profiles (, list, )
    GlobalProtect host information profile list.


  destination_zone (, list, )
    List of destination zones.


  destination_ip (, list, )
    List of destination addresses.


  application (, list, )
    List of applications, application groups, and/or application filters.


  service (, list, )
    List of services and/or service groups.


  category (, list, )
    List of destination URL categories.


  action (, str, )
    The rule action.


  log_setting (, str, )
    Log forwarding profile.


  log_start (, bool, )
    Whether to log at session start.


  log_end (, bool, )
    Whether to log at session end.


  description (, str, )
    Description of the security rule.


  rule_type (, str, )
    Type of security rule (version 6.1 of PanOS and above).


  tag_name (, list, )
    List of tags associated with the rule.


  negate_source (, bool, )
    Match on the reverse of the 'source_ip' attribute


  negate_destination (, bool, )
    Match on the reverse of the 'destination_ip' attribute


  disabled (, bool, )
    Disable this rule.


  schedule (, str, )
    Schedule in which this rule is active.


  icmp_unreachable (, bool, )
    Send 'ICMP Unreachable'.


  disable_server_response_inspection (, bool, )
    Disables packet inspection from the server to the client.


  group_profile (, str, )
    Security profile group setting.


  antivirus (, str, )
    Name of the already defined antivirus profile.


  vulnerability (, str, )
    Name of the already defined vulnerability profile.


  spyware (, str, )
    Name of the already defined spyware profile.


  url_filtering (, str, )
    Name of the already defined url_filtering profile.


  file_blocking (, str, )
    Name of the already defined file_blocking profile.


  data_filtering (, str, )
    Name of the already defined data_filtering profile.


  wildfire_analysis (, str, )
    Name of the already defined wildfire_analysis profile.






Status
------




- This module is not guaranteed to have a backwards compatible interface. *[preview]*


- This module is maintained by community.



Authors
~~~~~~~

- Garfield Lee Freeman (@shinmog)

