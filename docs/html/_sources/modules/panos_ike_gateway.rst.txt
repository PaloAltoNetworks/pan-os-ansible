.. _panos_ike_gateway_module:


panos_ike_gateway -- Configures IKE gateway on the firewall with subset of settings.
====================================================================================

.. contents::
   :local:
   :depth: 1


Synopsis
--------

Use this to manage or define a gateway, including the configuration information necessary to perform Internet Key Exchange (IKE) protocol negotiation with a peer gateway. This is the Phase 1 portion of the IKE/IPSec VPN setup.




Requirements
------------
The below requirements are needed on the host that executes this module.

- pan-python can be obtained from PyPI https://pypi.python.org/pypi/pan-python
- pandevice can be obtained from PyPI https://pypi.python.org/pypi/pandevice



Parameters
----------

  name (required, type: str)
    Name for the profile.


  version (type: str, default: ikev2)
    Specify the priority for Diffie-Hellman (DH) groups.


  interface (type: str, default: ethernet1/1)
    Specify the outgoing firewall interface to the VPN tunnel.


  enable_passive_mode (type: bool, default: True)
    True to have the firewall only respond to IKE connections and never initiate them.


  enable_nat_traversal (type: bool)
    True to NAT Traversal mode


  enable_fragmentation (type: bool)
    True to enable IKE fragmentation

    Incompatible with pre-shared keys, or 'aggressive' exchange mode


  enable_liveness_check (type: bool, default: True)
    Enable sending empty information liveness check message.


  liveness_check_interval (type: int, default: 5)
    Delay interval before sending probing packets (in seconds).


  peer_ip_type (type: str, default: ip)
    IP or dynamic.


  peer_ip_value (type: str, default: 127.0.0.1)
    IPv4 address of the peer gateway.


  enable_dead_peer_detection (type: bool)
    True to enable Dead Peer Detection on the gateway.


  dead_peer_detection_interval (type: int, default: 99)
    Time in seconds to check for a dead peer.


  dead_peer_detection_retry (type: int, default: 10)
    Retry attempts before peer is marked dead.


  local_ip_address (type: str)
    Bind IKE gateway to the specified interface IP address.  Only needed if 'interface' has multiple IP addresses associated with it.

    It should include the mask, such as '192.168.1.1/24'


  local_ip_address_type (type: str)
    The type of the bound interface IP address.

    ip: Specify exact IP address if interface has multiple addresses.

    floating-ip: Floating IP address in HA Active-Active configuration.

    Required when 'local_ip_address' is set.


  pre_shared_key (type: str, default: CHANGEME)
    Specify pre-shared key.


  local_id_type (type: str)
    Define the format of the identification of the local gateway.

    ipaddr: IP address

    fqdn: FQDN (hostname)

    ufqdn: User FQDN (email address)

    keyid: Key ID (binary format ID string in hex)


  local_id_value (type: str)
    Define the value for the identification of the local gateway.

    Required when *local_id_type* is set.


  peer_id_type (type: str)
    Define the format of the identification of the peer gateway.

    ipaddr: IP address

    fqdn: FQDN (hostname)

    ufqdn: User FQDN (email address)

    keyid: Key ID (binary format ID string in hex)


  peer_id_value (type: str)
    Define the value for the identification of the peer gateway.

    Required when *peer_id_type* is set.


  peer_id_check (type: str)
    Type of checking to do on peer_id.


  ikev1_crypto_profile (type: str, default: default)
    Crypto profile for IKEv1.


  ikev1_exchange_mode (type: str)
    The IKE exchange mode to use


  ikev2_crypto_profile (type: str, default: default)
    Crypto profile for IKEv2.


  commit (type: bool)
    Commit configuration if changed.


  provider (type: )
    A dict object containing connection details.


    ip_address (type: str)
      The IP address or hostname of the PAN-OS device being configured.


    username (type: str, default: admin)
      The username to use for authentication.  This is ignored if *api_key* is specified.


    password (type: str)
      The password to use for authentication.  This is ignored if *api_key* is specified.


    api_key (type: str)
      The API key to use instead of generating it using *username* / *password*.


    port (type: int, default: 443)
      The port number to connect to the PAN-OS device on.


    serial_number (type: str)
      The serial number of a firewall to use for targeted commands. If *ip_address* is not a Panorama PAN-OS device, then this param is ignored.



  ip_address (type: str)
    **Deprecated**

    Use *provider* to specify PAN-OS connectivity instead.

    ------------

    The IP address or hostname of the PAN-OS device being configured.


  username (type: str, default: admin)
    **Deprecated**

    Use *provider* to specify PAN-OS connectivity instead.

    ------------

    The username to use for authentication.  This is ignored if *api_key* is specified.


  password (type: str)
    **Deprecated**

    Use *provider* to specify PAN-OS connectivity instead.

    ------------

    The password to use for authentication.  This is ignored if *api_key* is specified.


  api_key (type: str)
    **Deprecated**

    Use *provider* to specify PAN-OS connectivity instead.

    ------------

    The API key to use instead of generating it using *username* / *password*.


  port (type: int, default: 443)
    **Deprecated**

    Use *provider* to specify PAN-OS connectivity instead.

    ------------

    The port number to connect to the PAN-OS device on.


  state (type: str, default: present)
    The state.


  template (type: str)
    (Panorama only) The template this operation should target. Mutually exclusive with *template_stack*.


  template_stack (type: str)
    (Panorama only) The template stack this operation should target. Mutually exclusive with *template*.





Notes
-----

.. note::
   - Panorama is supported.
   - Check mode is supported.
   - PAN-OS connectivity should be specified using *provider* or the classic PAN-OS connectivity params (*ip_address*, *username*, *password*, *api_key*, and *port*).  If both are present, then the classic params are ignored.
   - If the PAN-OS to be configured is Panorama, either *template* or *template_stack* must be specified.




Examples
--------

.. code-block:: yaml+jinja

    
    - name: Add IKE gateway config to the firewall
      panos_ike_gateway:
        provider: '{{ provider }}'
        state: 'present'
        name: 'IKEGW-Ansible'
        version: 'ikev2'
        interface: 'ethernet1/1'
        enable_passive_mode: True
        enable_liveness_check: True
        liveness_check_interval: '5'
        peer_ip_value: '1.2.3.4'
        pre_shared_key: 'CHANGEME'
        ikev2_crypto_profile: 'IKE-Ansible'
        commit: False

    - name: Create IKE gateway (dynamic)
      panos_ike_gateway:
        provider: '{{ device }}'
        name: 'test-dynamic'
        interface: 'ethernet1/1'
        peer_ip_type: dynamic
        pre_shared_key: 'CHANGEME'
        commit: False





Status
------




- This module is not guaranteed to have a backwards compatible interface. *[preview]*


- This module is maintained by community.



Authors
~~~~~~~

- Ivan Bojer (@ivanbojer)

