

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Examples &mdash; Palo Alto Networks Ansible Collection  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9a2dae69"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Module reference" href="modules.html" />
    <link rel="prev" title="Gathered Filter" href="gatheredfilter.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Palo Alto Networks Ansible Collection
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="gatheredfilter.html">Gathered Filter</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#add-security-policy-to-firewall-or-panorama">Add security policy to Firewall or Panorama</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#firewall">Firewall</a></li>
<li class="toctree-l3"><a class="reference internal" href="#panorama">Panorama</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#add-nat-policy-to-firewall-or-panorama">Add NAT policy to Firewall or Panorama</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">Firewall</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">Panorama</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#change-firewall-admin-password-using-ssh">Change firewall admin password using SSH</a></li>
<li class="toctree-l2"><a class="reference internal" href="#generates-self-signed-certificate">Generates self-signed certificate</a></li>
<li class="toctree-l2"><a class="reference internal" href="#check-if-fw-is-ready">Check if FW is ready</a></li>
<li class="toctree-l2"><a class="reference internal" href="#import-configuration">Import configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dhcp-on-data-port">DHCP on data port</a></li>
<li class="toctree-l2"><a class="reference internal" href="#load-configuration">Load configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#event-driven-ansible-eda">Event-Driven Ansible (EDA)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#http-server-profile">HTTP Server Profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rulebook-rulebook-yml">Rulebook - rulebook.yml</a></li>
<li class="toctree-l3"><a class="reference internal" href="#inventory">Inventory</a></li>
<li class="toctree-l3"><a class="reference internal" href="#playbook-decryption-remediation-yml">Playbook - decryption_remediation.yml</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Module reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">Release History</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Palo Alto Networks Ansible Collection</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Examples</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/PaloAltoNetworks/pan-os-ansible/blob/master/docs/source/examples.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="examples">
<h1>Examples<a class="headerlink" href="#examples" title="Link to this heading"></a></h1>
<section id="add-security-policy-to-firewall-or-panorama">
<h2>Add security policy to Firewall or Panorama<a class="headerlink" href="#add-security-policy-to-firewall-or-panorama" title="Link to this heading"></a></h2>
<p>Security policies allow you to enforce rules and take action, and can
be as general or specific as needed. The policy rules are compared
against the incoming traffic in sequence, and because the first rule
that matches the traffic is applied, the more specific rules must
precede the more general ones.</p>
<section id="firewall">
<h3>Firewall<a class="headerlink" href="#firewall" title="Link to this heading"></a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Add test rule 1 to the firewall</span>
<span class="w">  </span><span class="nt">paloaltonetworks.panos.panos_security_rule</span><span class="p">:</span>
<span class="w">    </span><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">provider</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">    </span><span class="nt">rule_name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;Ansible</span><span class="nv"> </span><span class="s">test</span><span class="nv"> </span><span class="s">1&#39;</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;An</span><span class="nv"> </span><span class="s">Ansible</span><span class="nv"> </span><span class="s">test</span><span class="nv"> </span><span class="s">rule&#39;</span>
<span class="w">    </span><span class="nt">source_zone</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;internal&#39;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">destination_zone</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;external&#39;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">source_ip</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;1.2.3.4&#39;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">source_user</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;any&#39;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">destination_ip</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;any&#39;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;any&#39;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">application</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;any&#39;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">service</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;service-http&#39;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">hip_profiles</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;any&#39;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">action</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;allow&#39;</span>
<span class="w">    </span><span class="nt">commit</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span>
</pre></div>
</div>
</section>
<section id="panorama">
<h3>Panorama<a class="headerlink" href="#panorama" title="Link to this heading"></a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Add test pre-rule to Panorama</span>
<span class="w">  </span><span class="nt">paloaltonetworks.panos.panos_security_rule</span><span class="p">:</span>
<span class="w">    </span><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">provider</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">    </span><span class="nt">rule_name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;Ansible</span><span class="nv"> </span><span class="s">test</span><span class="nv"> </span><span class="s">1&#39;</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;An</span><span class="nv"> </span><span class="s">Ansible</span><span class="nv"> </span><span class="s">test</span><span class="nv"> </span><span class="s">pre-rule&#39;</span>
<span class="w">    </span><span class="nt">source_zone</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;internal&#39;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">destination_zone</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;external&#39;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">source_ip</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;1.2.3.4&#39;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">source_user</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;any&#39;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">destination_ip</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;any&#39;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;any&#39;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">application</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;any&#39;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">service</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;service-http&#39;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">hip_profiles</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;any&#39;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">action</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;allow&#39;</span>
<span class="w">    </span><span class="nt">device_group</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;DeviceGroupA&#39;</span>
<span class="w">    </span><span class="nt">commit</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
</pre></div>
</div>
</section>
</section>
<section id="add-nat-policy-to-firewall-or-panorama">
<h2>Add NAT policy to Firewall or Panorama<a class="headerlink" href="#add-nat-policy-to-firewall-or-panorama" title="Link to this heading"></a></h2>
<p>If you define Layer 3 interfaces on the firewall, you can configure a
Network Address Translation (NAT) policy to specify whether source or
destination IP addresses and ports are converted between public and
private addresses and ports. For example, private source addresses can
be translated to public addresses on traffic sent from an internal
(trusted) zone to a public (untrusted) zone. NAT is also supported on
virtual wire interfaces.</p>
<section id="id1">
<h3>Firewall<a class="headerlink" href="#id1" title="Link to this heading"></a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Add the service object to the firewall first</span>
<span class="w">  </span><span class="nt">paloaltonetworks.panos.panos_service_object</span><span class="p">:</span>
<span class="w">    </span><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">provider</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;service-tcp-221&#39;</span>
<span class="w">    </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;tcp&#39;</span>
<span class="w">    </span><span class="nt">destination_port</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;221&#39;</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;SSH</span><span class="nv"> </span><span class="s">on</span><span class="nv"> </span><span class="s">port</span><span class="nv"> </span><span class="s">221&#39;</span>
<span class="w">    </span><span class="nt">commit</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>

<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Create dynamic NAT rule on the firewall</span>
<span class="w">  </span><span class="nt">paloaltonetworks.panos.panos_nat_rule</span><span class="p">:</span>
<span class="w">    </span><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">provider</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">    </span><span class="nt">rule_name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;Web</span><span class="nv"> </span><span class="s">SSH</span><span class="nv"> </span><span class="s">inbound&#39;</span>
<span class="w">    </span><span class="nt">source_zone</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;external&#39;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">destination_zone</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;external&#39;</span>
<span class="w">    </span><span class="nt">source_ip</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;any&#39;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">destination_ip</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;10.0.0.100&#39;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">service</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;service-tcp-221&#39;</span>
<span class="w">    </span><span class="nt">snat_type</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;dynamic-ip-and-port&#39;</span>
<span class="w">    </span><span class="nt">snat_interface</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;ethernet1/2&#39;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">dnat_address</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;10.0.1.101&#39;</span>
<span class="w">    </span><span class="nt">dnat_port</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;22&#39;</span>
</pre></div>
</div>
</section>
<section id="id2">
<h3>Panorama<a class="headerlink" href="#id2" title="Link to this heading"></a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Add the necessary service object to Panorama first</span>
<span class="w">  </span><span class="nt">paloaltonetworks.panos.panos_object</span><span class="p">:</span>
<span class="w">    </span><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">provider</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;service-tcp-221&#39;</span>
<span class="w">    </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;tcp&#39;</span>
<span class="w">    </span><span class="nt">destination_port</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;221&#39;</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;SSH</span><span class="nv"> </span><span class="s">on</span><span class="nv"> </span><span class="s">port</span><span class="nv"> </span><span class="s">221&#39;</span>
<span class="w">    </span><span class="nt">commit</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">    </span><span class="nt">device_group</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;shared_services_11022&#39;</span>

<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Create dynamic NAT rule on Panorama</span>
<span class="w">  </span><span class="nt">paloaltonetworks.panos.panos_nat_rule</span><span class="p">:</span>
<span class="w">    </span><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">provider</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">    </span><span class="nt">rule_name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;Web</span><span class="nv"> </span><span class="s">SSH</span><span class="nv"> </span><span class="s">inbound&#39;</span>
<span class="w">    </span><span class="nt">source_zone</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;external&#39;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">destination_zone</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;external&#39;</span>
<span class="w">    </span><span class="nt">source_ip</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;any&#39;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">destination_ip</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;10.0.0.100&#39;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">service</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;service-tcp-221&#39;</span>
<span class="w">    </span><span class="nt">snat_type</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;dynamic-ip-and-port&#39;</span>
<span class="w">    </span><span class="nt">snat_interface</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;ethernet1/2&#39;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">dnat_address</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;10.0.1.101&#39;</span>
<span class="w">    </span><span class="nt">dnat_port</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;22&#39;</span>
<span class="w">    </span><span class="nt">device_group</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;shared_services_11022&#39;</span>
</pre></div>
</div>
</section>
</section>
<section id="change-firewall-admin-password-using-ssh">
<h2>Change firewall admin password using SSH<a class="headerlink" href="#change-firewall-admin-password-using-ssh" title="Link to this heading"></a></h2>
<p>Change admin password of PAN-OS device using SSH with SSH key. This is
used in particular when NGFW is deployed in the cloud (such as AWS).</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Change user password using ssh protocol</span>
<span class="w">  </span><span class="nt">paloaltonetworks.panos.panos_admpwd</span><span class="p">:</span>
<span class="w">    </span><span class="nt">ip_address</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">ip_address</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">    </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">username</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">    </span><span class="nt">newpassword</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">new_password</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">    </span><span class="nt">key_filename</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">key_filename</span><span class="nv"> </span><span class="s">}}&#39;</span>
</pre></div>
</div>
</section>
<section id="generates-self-signed-certificate">
<h2>Generates self-signed certificate<a class="headerlink" href="#generates-self-signed-certificate" title="Link to this heading"></a></h2>
<p>This module generates a self-signed certificate that can be used by
GlobalProtect client, SSL connector, or otherwise. Root certificate
must be preset on the system first. This module depends on paramiko
for ssh.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">generate self signed certificate</span>
<span class="w">  </span><span class="nt">paloaltonetworks.panos.panos_cert_gen_ssh</span><span class="p">:</span>
<span class="w">    </span><span class="nt">ip_address</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">ip_address</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">    </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">username</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">    </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">password</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">    </span><span class="nt">cert_cn</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">cn</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">    </span><span class="nt">cert_friendly_name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">friendly_name</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">    </span><span class="nt">signed_by</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">signed_by</span><span class="nv"> </span><span class="s">}}&quot;</span>
</pre></div>
</div>
</section>
<section id="check-if-fw-is-ready">
<h2>Check if FW is ready<a class="headerlink" href="#check-if-fw-is-ready" title="Link to this heading"></a></h2>
<p>Check if PAN-OS device is ready for being configured (no pending
jobs). The check could be done once or multiple times until the device
is ready.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Wait for FW reboot</span>
<span class="w">  </span><span class="nt">paloaltonetworks.panos.panos_check</span><span class="p">:</span>
<span class="w">    </span><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">provider</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">  </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">result</span>
<span class="w">  </span><span class="nt">until</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not result|failed</span>
<span class="w">  </span><span class="nt">retries</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50</span>
<span class="w">  </span><span class="nt">delay</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
</pre></div>
</div>
</section>
<section id="import-configuration">
<h2>Import configuration<a class="headerlink" href="#import-configuration" title="Link to this heading"></a></h2>
<p>Import file into PAN-OS device.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">import configuration file into PAN-OS</span>
<span class="w">  </span><span class="nt">paloaltonetworks.panos.panos_import</span><span class="p">:</span>
<span class="w">    </span><span class="nt">ip_address</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">ip_address</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">    </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">username</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">    </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">password</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">    </span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">config_file</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">    </span><span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;configuration&quot;</span>
</pre></div>
</div>
</section>
<section id="dhcp-on-data-port">
<h2>DHCP on data port<a class="headerlink" href="#dhcp-on-data-port" title="Link to this heading"></a></h2>
<p>Configure data-port (DP) network interface for DHCP. By default DP
interfaces are static.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enable DHCP client on ethernet1/1 in zone external</span>
<span class="w">  </span><span class="nt">paloaltonetworks.panos.panos_interface</span><span class="p">:</span>
<span class="w">    </span><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">provider</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">    </span><span class="nt">if_name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ethernet1/1&quot;</span>
<span class="w">    </span><span class="nt">zone_name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;external&quot;</span>
<span class="w">    </span><span class="nt">create_default_route</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">commit</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
</pre></div>
</div>
</section>
<section id="load-configuration">
<h2>Load configuration<a class="headerlink" href="#load-configuration" title="Link to this heading"></a></h2>
<p>This is example playbook that imports and loads firewall
configuration from a configuration file</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">import config</span>
<span class="w">  </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-firewall</span>
<span class="w">  </span><span class="nt">connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">local</span>
<span class="w">  </span><span class="nt">gather_facts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>

<span class="w">  </span><span class="nt">vars</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cfg_file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">candidate-template-empty.xml</span>

<span class="w">  </span><span class="nt">roles</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">role</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PaloAltoNetworks.paloaltonetworks</span>

<span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Grab the credentials from ansible-vault</span>
<span class="w">    </span><span class="nt">include_vars</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;firewall-secrets.yml&#39;</span>
<span class="w">    </span><span class="nt">no_log</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;yes&#39;</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">wait for SSH (timeout 10min)</span>
<span class="w">    </span><span class="nt">wait_for</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">port=22 host=&#39;{{ provider.ip_address }}&#39; search_regex=SSH timeout=600</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">checking if device ready</span>
<span class="w">    </span><span class="nt">paloaltonetworks.panos.panos_check</span><span class="p">:</span>
<span class="w">      </span><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">provider</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">    </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">result</span>
<span class="w">    </span><span class="nt">until</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not result|failed</span>
<span class="w">    </span><span class="nt">retries</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">    </span><span class="nt">delay</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">import configuration</span>
<span class="w">    </span><span class="nt">paloaltonetworks.panos.panos_import</span><span class="p">:</span>
<span class="w">      </span><span class="nt">ip_address</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">provider.ip_address</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">      </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">provider.username</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">      </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">provider.password</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">      </span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{cfg_file}}&#39;</span>
<span class="w">      </span><span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;configuration&#39;</span>
<span class="w">    </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">result</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">load configuration</span>
<span class="w">    </span><span class="nt">paloaltonetworks.panos.panos_loadcfg</span><span class="p">:</span>
<span class="w">      </span><span class="nt">ip_address</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">provider.ip_address</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">      </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">provider.username</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">      </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">provider.password</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">      </span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{result.filename}}&#39;</span>
<span class="w">      </span><span class="nt">commit</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">set admin password</span>
<span class="w">    </span><span class="nt">paloaltonetworks.panos.panos_administrator</span><span class="p">:</span>
<span class="w">      </span><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">provider</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">      </span><span class="nt">admin_username</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;admin&#39;</span>
<span class="w">      </span><span class="nt">admin_password</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">provider.password</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">      </span><span class="nt">superuser</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span>
<span class="w">      </span><span class="nt">commit</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">commit (blocks until finished)</span>
<span class="w">    </span><span class="nt">paloaltonetworks.panos.panos_commit</span><span class="p">:</span>
<span class="w">      </span><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">provider</span><span class="nv"> </span><span class="s">}}&#39;</span>
</pre></div>
</div>
</section>
<section id="event-driven-ansible-eda">
<h2>Event-Driven Ansible (EDA)<a class="headerlink" href="#event-driven-ansible-eda" title="Link to this heading"></a></h2>
<p>Event-Driven Ansible is a responsive automation solution that can
process events containing discrete, actionable intelligence.
The <cite>extensions/plugins/event_source/logs.py</cite> plugin is capable of
receiving JSON structured messages from a PAN-OS firewall, restructures
the payload as a Python dictionary, determines the appropriate response
to the event, and then executes automated actions to address or remediate
based on the situation.</p>
<p>There are four components needed to implement this example EDA use case
with PAN-OS:</p>
<ul class="simple">
<li><p>HTTP server profile: A PAN-OS firewall configuration that defines
how the PAN-OS firewall(s) should send events to the EDA server.</p></li>
<li><p>EDA rulebook: A YAML file which describes events of interest, and how to
EDA respond to them based on conditions.</p></li>
<li><p>Inventory: A YAML file that defines the PAN-OS firewall(s) to be
executed against when a condition is met.</p></li>
<li><p>Ansible playbook: A YAML file that defines the Ansible tasks to be executed
when a condition is met.</p></li>
</ul>
<p>The four components are described here in the context of a use case of
detecting decryption issues based on the Decryption Logs, and responding
by placing the relevant URLs into a category used for decryption bypass.</p>
<section id="http-server-profile">
<h3>HTTP Server Profile<a class="headerlink" href="#http-server-profile" title="Link to this heading"></a></h3>
<p>The following example shows what a Decryption HTTP server profile
would look like in PAN-OS. The HTTP server profile is configured to
send logs to the EDA server.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;category&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;network&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;details&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;action&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;$action&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;app&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;$app&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;cn&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;$cn&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;dst&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;$dst&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;device_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;$device_name&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;error&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;$error&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;issuer_cn&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;$issuer_cn&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;root_cn&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;$root_cn&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;root_status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;$root_status&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;sni&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;$sni&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;src&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;$src&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;srcuser&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;$srcuser&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;receive_time&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;$receive_time&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;rule&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;$rule&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;rule_uuid&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;$rule_uuid&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;serial&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;$serial&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;sessionid&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;$sessionid&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;severity&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;informational&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;decryption&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This HTTP Server Profile could be configured in its entirety using the
following tasks in an Ansible playbook:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Create a HTTP Server Profile for Decryption Logs</span>
<span class="w">  </span><span class="nt">paloaltonetworks.panos.panos_http_profile</span><span class="p">:</span>
<span class="w">    </span><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">device</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">server_profile_name_decrypt</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">    </span><span class="nt">decryption_name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;decryption-logs-to-eda&#39;</span>
<span class="w">    </span><span class="nt">decryption_uri_format</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;https://test&#39;</span>
<span class="w">    </span><span class="nt">decryption_payload</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">      </span><span class="no">{</span>
<span class="w">          </span><span class="no">&quot;category&quot;: &quot;network&quot;,</span>
<span class="w">          </span><span class="no">&quot;details&quot;: {</span>
<span class="w">              </span><span class="no">&quot;action&quot;: &quot;$action&quot;,</span>
<span class="w">              </span><span class="no">&quot;app&quot;: &quot;$app&quot;,</span>
<span class="w">              </span><span class="no">&quot;cn&quot;: &quot;$cn&quot;,</span>
<span class="w">              </span><span class="no">&quot;dst&quot;: &quot;$dst&quot;,</span>
<span class="w">              </span><span class="no">&quot;device_name&quot;: &quot;$device_name&quot;,</span>
<span class="w">              </span><span class="no">&quot;error&quot;: &quot;$error&quot;,</span>
<span class="w">              </span><span class="no">&quot;issuer_cn&quot;: &quot;$issuer_cn&quot;,</span>
<span class="w">              </span><span class="no">&quot;root_cn&quot;: &quot;$root_cn&quot;,</span>
<span class="w">              </span><span class="no">&quot;root_status&quot;: &quot;$root_status&quot;,</span>
<span class="w">              </span><span class="no">&quot;sni&quot;: &quot;$sni&quot;,</span>
<span class="w">              </span><span class="no">&quot;src&quot;: &quot;$src&quot;,</span>
<span class="w">              </span><span class="no">&quot;srcuser&quot;: &quot;$srcuser&quot;</span>
<span class="w">          </span><span class="no">},</span>
<span class="w">          </span><span class="no">&quot;receive_time&quot;: &quot;$receive_time&quot;,</span>
<span class="w">          </span><span class="no">&quot;rule&quot;: &quot;$rule&quot;,</span>
<span class="w">          </span><span class="no">&quot;rule_uuid&quot;: &quot;$rule_uuid&quot;,</span>
<span class="w">          </span><span class="no">&quot;serial&quot;: &quot;$serial&quot;,</span>
<span class="w">          </span><span class="no">&quot;sessionid&quot;: &quot;$sessionid&quot;,</span>
<span class="w">          </span><span class="no">&quot;severity&quot;: &quot;informational&quot;,</span>
<span class="w">          </span><span class="no">&quot;type&quot;: &quot;decryption&quot;</span>
<span class="w">      </span><span class="no">}</span>

<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Create HTTP server</span>
<span class="w">  </span><span class="nt">paloaltonetworks.panos.panos_http_server</span><span class="p">:</span>
<span class="w">    </span><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">device</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">    </span><span class="nt">http_profile</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">server_profile_name_decrypt</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;my-EDA-server&#39;</span>
<span class="w">    </span><span class="nt">address</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;192.168.1.5&#39;</span>
<span class="w">    </span><span class="nt">http_method</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;GET&#39;</span>
<span class="w">    </span><span class="nt">http_port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5000</span>

<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Add a HTTP header to HTTP Server Profile</span>
<span class="w">  </span><span class="nt">paloaltonetworks.panos.panos_http_profile_header</span><span class="p">:</span>
<span class="w">    </span><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">device</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">    </span><span class="nt">http_profile</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">server_profile_name_decrypt</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">    </span><span class="nt">log_type</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;decryption&#39;</span>
<span class="w">    </span><span class="nt">header</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;Content-Type&#39;</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;application/json&#39;</span>

<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Add a param to the config log type</span>
<span class="w">  </span><span class="nt">paloaltonetworks.panos.panos_http_profile_param</span><span class="p">:</span>
<span class="w">    </span><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">device</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">    </span><span class="nt">http_profile</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">server_profile_name_decrypt</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">    </span><span class="nt">log_type</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;decryption&#39;</span>
<span class="w">    </span><span class="nt">param</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;serial&#39;</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;$serial&#39;</span>
</pre></div>
</div>
<p>The HTTP Server Profile would be used in a Log Forwarding Profile
with a filter for only forwarding Decryption Logs when there has
been an issue with decryption. Here are example Ansible tasks to
create a Log Forwarding Profile:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Create log forwarding profile</span>
<span class="w">  </span><span class="nt">paloaltonetworks.panos.panos_log_forwarding_profile</span><span class="p">:</span>
<span class="w">    </span><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">provider</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;EDA_LFP&#39;</span>
<span class="w">    </span><span class="nt">enhanced_logging</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>

<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Create log forwarding profile match list</span>
<span class="w">  </span><span class="nt">paloaltonetworks.panos.panos_log_forwarding_profile_match_list</span><span class="p">:</span>
<span class="w">    </span><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">provider</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">    </span><span class="nt">log_forwarding_profile</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;EDA_LFP&#39;</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;eda-decryption-forwarding&#39;</span>
<span class="w">    </span><span class="nt">log_type</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;decryption&#39;</span>
<span class="w">    </span><span class="nt">filter</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;(</span><span class="nv"> </span><span class="s">err_index</span><span class="nv"> </span><span class="s">neq</span><span class="nv"> </span><span class="s">None</span><span class="nv"> </span><span class="s">)</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">(</span><span class="nv"> </span><span class="s">proxy_type</span><span class="nv"> </span><span class="s">eq</span><span class="nv"> </span><span class="s">Forward</span><span class="nv"> </span><span class="s">)&#39;</span>
<span class="w">    </span><span class="nt">http_profiles</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">server_profile_name_decrypt</span><span class="nv"> </span><span class="s">}}&#39;</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
</section>
<section id="rulebook-rulebook-yml">
<h3>Rulebook - rulebook.yml<a class="headerlink" href="#rulebook-rulebook-yml" title="Link to this heading"></a></h3>
<p>This rulebook shows an example of how to configure EDA to receive
the decryption logs from PAN-OS, and execute a remediation playbook:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Receive</span><span class="nv"> </span><span class="s">logs</span><span class="nv"> </span><span class="s">sourced</span><span class="nv"> </span><span class="s">from</span><span class="nv"> </span><span class="s">HTTP</span><span class="nv"> </span><span class="s">Server</span><span class="nv"> </span><span class="s">Profile</span><span class="nv"> </span><span class="s">in</span><span class="nv"> </span><span class="s">PAN-OS&quot;</span>
<span class="w">  </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;localhost&quot;</span>

<span class="w">  </span><span class="c1">## Define how our plugin should listen for logs from PAN-OS</span>
<span class="w">  </span><span class="nt">sources</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">paloaltonetworks.panos.logs</span><span class="p">:</span>
<span class="w">        </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0.0.0</span>
<span class="w">        </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5000</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">decryption</span>

<span class="w">  </span><span class="c1">## Define the conditions we are looking for. There are many types of logs</span>
<span class="w">  </span><span class="c1">## in PAN-OS; we are looking just for decryption logs</span>
<span class="w">  </span><span class="nt">rules</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Troubleshoot</span><span class="nv"> </span><span class="s">Decryption</span><span class="nv"> </span><span class="s">Failure&quot;</span>
<span class="w">      </span><span class="nt">condition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">event.meta.log_type == &quot;decryption&quot;</span>

<span class="w">      </span><span class="c1">## Define the action we should take should the condition be met,</span>
<span class="w">      </span><span class="c1">## when we find a decryption log, which is to execute the</span>
<span class="w">      </span><span class="c1">## remediation playbook</span>
<span class="w">      </span><span class="nt">action</span><span class="p">:</span>
<span class="w">        </span><span class="nt">run_playbook</span><span class="p">:</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;playbooks/decryption_remediation.yml&quot;</span>
</pre></div>
</div>
</section>
<section id="inventory">
<h3>Inventory<a class="headerlink" href="#inventory" title="Link to this heading"></a></h3>
<p>The inventory for this example use case is one that defines all hosts
(firewalls) to be local connectivity, as this is how Ansible communicates
with PAN-OS:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">all</span><span class="p">:</span>
<span class="w">  </span><span class="nt">hosts</span><span class="p">:</span>
<span class="w">    </span><span class="nt">localhost</span><span class="p">:</span>
<span class="w">      </span><span class="nt">ansible_connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">local</span>
</pre></div>
</div>
</section>
<section id="playbook-decryption-remediation-yml">
<h3>Playbook - decryption_remediation.yml<a class="headerlink" href="#playbook-decryption-remediation-yml" title="Link to this heading"></a></h3>
<p>The playbook executed when the conditions in the rulebook are met, in
this example use case, performs tasks to add the relevant URL into a
category used to bypass decryption, thus remediating the problem:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Decryption Remediation Playbook</span>
<span class="w">  </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;all&#39;</span>
<span class="w">  </span><span class="nt">gather_facts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">  </span><span class="nt">connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">local</span>

<span class="w">  </span><span class="nt">vars</span><span class="p">:</span>
<span class="w">    </span><span class="nt">device</span><span class="p">:</span>
<span class="w">      </span><span class="nt">ip_address</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.1.10&quot;</span>
<span class="w">      </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;admin&quot;</span>
<span class="w">      </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;redacted&quot;</span>

<span class="w">    </span><span class="nt">bypass_category_name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;decryption-bypass&#39;</span>


<span class="w">  </span><span class="c1">## When EDA calls this playbook for execution, it takes the SNI (Server Name Indication)</span>
<span class="w">  </span><span class="c1">## from the decryption logs where a site failed to be decrypted properly, and adds the</span>
<span class="w">  </span><span class="c1">## SNI to the list of domains in a URL category. This URL category is used as match</span>
<span class="w">  </span><span class="c1">## criteria, therefore domains in this URL category will no longer be decrypted by the</span>
<span class="w">  </span><span class="c1">## decryption policy rule.</span>

<span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">    </span><span class="c1">## Gather up the list of domains currently in the URL category</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Get current decryption bypass domains</span>
<span class="w">      </span><span class="nt">paloaltonetworks.panos.panos_custom_url_category</span><span class="p">:</span>
<span class="w">        </span><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">device</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;gathered&quot;</span>
<span class="w">        </span><span class="nt">gathered_filter</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;name</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">bypass_category_name</span><span class="nv"> </span><span class="s">}}&#39;&quot;</span>
<span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bypass_category</span>

<span class="w">    </span><span class="c1">## If the URL category already has some domains, add this SNI to the list (&#39;url_value&#39;)</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Update decryption bypass category with new domain, if category is currently not empty</span>
<span class="w">      </span><span class="nt">paloaltonetworks.panos.panos_custom_url_category</span><span class="p">:</span>
<span class="w">        </span><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">device</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">bypass_category_name</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">        </span><span class="nt">url_value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">bypass_category.gathered[0].url_value</span><span class="nv"> </span><span class="s">+</span><span class="nv"> </span><span class="s">[ansible_eda.event.payload.details.sni]</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">      </span><span class="nt">when</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bypass_category.gathered[0].url_value != None</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ansible_eda.event.payload.details.sni not in bypass_category.gathered[0].url_value</span>

<span class="w">    </span><span class="c1">## If the URL category is empty, create the list (&#39;url_value&#39;) with this SNI</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Create decryption bypass category with new domain, if category is currently empty</span>
<span class="w">      </span><span class="nt">paloaltonetworks.panos.panos_custom_url_category</span><span class="p">:</span>
<span class="w">        </span><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">device</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">bypass_category_name</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">        </span><span class="nt">url_value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">[ansible_eda.event.payload.details.sni]</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">      </span><span class="nt">when</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bypass_category.gathered[0].url_value == None</span>

<span class="w">    </span><span class="c1">## Having added the site&#39;s SNI to the URL category, make this change live by performing a &#39;commit&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Commit configuration</span>
<span class="w">      </span><span class="nt">paloaltonetworks.panos.panos_commit_firewall</span><span class="p">:</span>
<span class="w">        </span><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">device</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">results</span>

<span class="w">    </span><span class="c1">## Output results of the commit</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Output commit results</span>
<span class="w">      </span><span class="nt">ansible.builtin.debug</span><span class="p">:</span>
<span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Commit</span><span class="nv"> </span><span class="s">with</span><span class="nv"> </span><span class="s">Job</span><span class="nv"> </span><span class="s">ID:</span><span class="nv"> </span><span class="s">{{</span><span class="nv"> </span><span class="s">results.jobid</span><span class="nv"> </span><span class="s">}}</span><span class="nv"> </span><span class="s">had</span><span class="nv"> </span><span class="s">output:</span><span class="nv"> </span><span class="s">{{</span><span class="nv"> </span><span class="s">results</span><span class="nv"> </span><span class="s">}}&quot;</span>
</pre></div>
</div>
<p>An alternative remediation if the web server hosting the URL is not presenting
the relevant intermediate certificate, would be to add the intermediate
certificate into the PAN-OS certificate store, and not use a bypass (which weakens
visibility by leaving more traffic encrypted) like the previous example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Get intermediate certificate URL</span>
<span class="w">    </span><span class="nt">ansible.builtin.set_fact</span><span class="p">:</span>
<span class="w">      </span><span class="nt">intermediate_cert_url</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">ansible_eda.event.payload.details.error</span><span class="nv"> </span><span class="s">|</span><span class="nv"> </span><span class="s">regex_search(regex_query,</span><span class="nv"> </span><span class="s">ignorecase=True)</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">    </span><span class="nt">vars</span><span class="p">:</span>
<span class="w">      </span><span class="nt">regex_query</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;(http(s)?:\/\/.)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&amp;//=]*)&#39;</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Get intermediate certificate filename</span>
<span class="w">    </span><span class="nt">ansible.builtin.set_fact</span><span class="p">:</span>
<span class="w">      </span><span class="nt">intermediate_cert_name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">intermediate_cert_url</span><span class="nv"> </span><span class="s">|</span><span class="nv"> </span><span class="s">regex_search(regex_query,</span><span class="nv"> </span><span class="s">ignorecase=True)</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">    </span><span class="nt">vars</span><span class="p">:</span>
<span class="w">      </span><span class="nt">regex_query</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;[^\/\\&amp;\?]+\.\w{3,4}(?=([\?&amp;].*$|$))&#39;</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Download intermediate certificate</span>
<span class="w">    </span><span class="nt">ansible.builtin.get_url</span><span class="p">:</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">intermediate_cert_url</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">      </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">intermediate_cert_name</span><span class="nv"> </span><span class="s">}}&#39;</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Convert intermediate certificate from DER format to PEM format</span>
<span class="w">    </span><span class="nt">ansible.builtin.command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">openssl x509 -inform DER -outform PEM -in {{ intermediate_cert_name }} -out {{ intermediate_cert_name }}.pem</span>
<span class="w">    </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output</span>
<span class="w">    </span><span class="nt">changed_when</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output.rc != 0</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Import intermediate certificate to NGFW</span>
<span class="w">    </span><span class="nt">paloaltonetworks.panos.panos_import</span><span class="p">:</span>
<span class="w">      </span><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">device</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">      </span><span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;certificate&#39;</span>
<span class="w">      </span><span class="nt">certificate_name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">intermediate_cert_name</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;pem&#39;</span>
<span class="w">      </span><span class="nt">filename</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">intermediate_cert_name</span><span class="nv"> </span><span class="s">}}.pem&#39;</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="gatheredfilter.html" class="btn btn-neutral float-left" title="Gathered Filter" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="modules.html" class="btn btn-neutral float-right" title="Module reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Palo Alto Networks.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>